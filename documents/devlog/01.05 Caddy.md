## Summary: what we have now

- Serving `dist/client` builds locally with Caddy. Caddy configured with cache expiry, compression

## Performance Metric Logs

### Before

Using `astro preview`

```
npm run build
npm run preview
```

```
npm run test:performance
```

Data at: `__generated__/lighthouse/2025-09-22-03-18-27/*`

```json
{
  "totalUrls": 8,
  "passedUrls": 5,
  "failedUrls": 3,
  "totalViolations": 4,
  "timestamp": "2025-09-22T03:18:27.810Z",
  "results": [
    {
      "url": "http://localhost:4321/",
      "passed": false,
      "violationCount": 1,
      "lighthouseScore": 100,
      "metrics": {
        "TBT": 0,
        "LCP": 1355,
        "CLS": 0.001,
        "FCP": 1355,
        "SI": 1355
      }
    },
    {
      "url": "http://localhost:4321/about/",
      "passed": true,
      "violationCount": 0,
      "lighthouseScore": 100,
      "metrics": {
        "TBT": 0,
        "LCP": 1353,
        "CLS": 0,
        "FCP": 1203,
        "SI": 1203
      }
    },
    {
      "url": "http://localhost:4321/blog/",
      "passed": false,
      "violationCount": 1,
      "lighthouseScore": 99,
      "metrics": {
        "TBT": 0,
        "LCP": 2032,
        "CLS": 0,
        "FCP": 1204,
        "SI": 1204
      }
    },
    {
      "url": "http://localhost:4321/blog/first-post/",
      "passed": true,
      "violationCount": 0,
      "lighthouseScore": 100,
      "metrics": {
        "TBT": 0,
        "LCP": 1277,
        "CLS": 0,
        "FCP": 1202,
        "SI": 1202
      }
    },
    {
      "url": "http://localhost:4321/blog/markdown-style-guide/",
      "passed": false,
      "violationCount": 2,
      "lighthouseScore": 99,
      "metrics": {
        "TBT": 0,
        "LCP": 2182,
        "CLS": 0.001,
        "FCP": 1204,
        "SI": 1204
      }
    },
    {
      "url": "http://localhost:4321/blog/second-post/",
      "passed": true,
      "violationCount": 0,
      "lighthouseScore": 100,
      "metrics": {
        "TBT": 0,
        "LCP": 1277,
        "CLS": 0,
        "FCP": 1202,
        "SI": 1202
      }
    },
    {
      "url": "http://localhost:4321/blog/third-post/",
      "passed": true,
      "violationCount": 0,
      "lighthouseScore": 100,
      "metrics": {
        "TBT": 0,
        "LCP": 1502,
        "CLS": 0,
        "FCP": 1202,
        "SI": 1202
      }
    },
    {
      "url": "http://localhost:4321/blog/using-mdx/",
      "passed": true,
      "violationCount": 0,
      "lighthouseScore": 100,
      "metrics": {
        "TBT": 0,
        "LCP": 1428,
        "CLS": 0,
        "FCP": 1052,
        "SI": 1052
      }
    }
  ]
}
```

### After

Using Caddy

```
npm run build
caddy run
```

```
npm run test:performance
```

Data at: `__generated__/lighthouse/2025-09-22-04-00-46/*`

```json
{
  "totalUrls": 8,
  "passedUrls": 7,
  "failedUrls": 1,
  "totalViolations": 1,
  "timestamp": "2025-09-22T04:00:46.479Z",
  "results": [
    {
      "url": "https://localhost:4321/",
      "passed": true,
      "violationCount": 0,
      "lighthouseScore": 100,
      "metrics": {
        "TBT": 0,
        "LCP": 1080,
        "CLS": 0,
        "FCP": 815,
        "SI": 815
      }
    },
    {
      "url": "https://localhost:4321/about/",
      "passed": true,
      "violationCount": 0,
      "lighthouseScore": 100,
      "metrics": {
        "TBT": 0,
        "LCP": 1380,
        "CLS": 0,
        "FCP": 804,
        "SI": 804
      }
    },
    {
      "url": "https://localhost:4321/blog/",
      "passed": true,
      "violationCount": 0,
      "lighthouseScore": 100,
      "metrics": {
        "TBT": 0,
        "LCP": 1080,
        "CLS": 0,
        "FCP": 806,
        "SI": 806
      }
    },
    {
      "url": "https://localhost:4321/blog/first-post/",
      "passed": true,
      "violationCount": 0,
      "lighthouseScore": 100,
      "metrics": {
        "TBT": 0,
        "LCP": 1380,
        "CLS": 0,
        "FCP": 802,
        "SI": 802
      }
    },
    {
      "url": "https://localhost:4321/blog/markdown-style-guide/",
      "passed": false,
      "violationCount": 1,
      "lighthouseScore": 100,
      "metrics": {
        "TBT": 0,
        "LCP": 1650,
        "CLS": 0,
        "FCP": 1350,
        "SI": 1350
      }
    },
    {
      "url": "https://localhost:4321/blog/second-post/",
      "passed": true,
      "violationCount": 0,
      "lighthouseScore": 100,
      "metrics": {
        "TBT": 0,
        "LCP": 1350,
        "CLS": 0,
        "FCP": 773,
        "SI": 773
      }
    },
    {
      "url": "https://localhost:4321/blog/third-post/",
      "passed": true,
      "violationCount": 0,
      "lighthouseScore": 100,
      "metrics": {
        "TBT": 0,
        "LCP": 1380,
        "CLS": 0,
        "FCP": 801,
        "SI": 801
      }
    },
    {
      "url": "https://localhost:4321/blog/using-mdx/",
      "passed": true,
      "violationCount": 0,
      "lighthouseScore": 100,
      "metrics": {
        "TBT": 0,
        "LCP": 1350,
        "CLS": 0,
        "FCP": 774,
        "SI": 774
      }
    }
  ]
}
```

## Notes

- Tried to get brotli working but wasn't successful. Could be handled instead by Netlify or Cloudfront when deploying
