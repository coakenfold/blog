---
slug: "03-01"
title: "03.01 Automated Lighthouse"
description: " Automated Lighthouse"
pubDate: "09-25-2025"
author: "Chad Oakenfold"
updatedDate: "09-25-2025"
---

## `./scripts/lighthouse.mjs`

Excerpt:

```javascript
// Configuration
const CONFIG = {
  sitemapPath: "./dist/sitemap-0.xml",
  outputDir: `./__generated__/lighthouse/${timestampFilename}`,
  runs: 3, // Number of runs to perform for each URL
  cooldownMs: 2000, // Cooldown between runs in milliseconds
  thresholds: {
    TBT: { max: 0, violationHandler: "console.error" }, // Total Blocking Time
    LCP: { max: 1514, violationHandler: "console.error" }, // Largest Contentful Paint
    CLS: { max: 0.0, violationHandler: "console.error" }, // Cumulative Layout Shift
    FCP: { max: 1514, violationHandler: "console.error" }, // First Contentful Paint
    SI: { max: 1514, violationHandler: "console.error" }, // Speed Index
  },
  chromeFlags: ["--headless", "--disable-gpu", "--no-sandbox"],
  lighthouseOptions: {
    logLevel: "error",
    output: "json",
    onlyCategories: ["performance"],
  },
};
```

## Run

```
npm run test:performance
```

## Output

```javascript
{
  "totalUrls": 4,
  "runsPerUrl": 3,
  "passedUrls": 3,
  "failedUrls": 1,
  "totalViolations": 1,
  "timestamp": "2025-09-26T01:40:05.819Z",
  "results": [
    {
      "url": "https://blog.oakenfold.ca/",
      "calculator": "https://googlechrome.github.io/lighthouse/scorecalc/#FCP=841&SI=841&LCP=841&TBT=0&CLS=0&device=mobile&version=10",
      "passed": true,
      "violationCount": 0,
      "medianLighthouseScore": 100,
      "medianMetrics": {
        "TBT": 0,
        "LCP": 841,
        "CLS": 0,
        "FCP": 841,
        "SI": 841
      },
      "totalRuns": 3,
      "successfulRuns": 3
    },
    {
      "url": "https://blog.oakenfold.ca/blog/",
      "calculator": "https://googlechrome.github.io/lighthouse/scorecalc/#FCP=829&SI=829&LCP=829&TBT=0&CLS=0&device=mobile&version=10",
      "passed": true,
      "violationCount": 0,
      "medianLighthouseScore": 100,
      "medianMetrics": {
        "TBT": 0,
        "LCP": 829,
        "CLS": 0,
        "FCP": 829,
        "SI": 829
      },
      "totalRuns": 3,
      "successfulRuns": 3
    },
    {
      "url": "https://blog.oakenfold.ca/blog/01-01/",
      "calculator": "https://googlechrome.github.io/lighthouse/scorecalc/#FCP=835&SI=835&LCP=835&TBT=0&CLS=0.001&device=mobile&version=10",
      "passed": false,
      "violationCount": 1,
      "medianLighthouseScore": 100,
      "medianMetrics": {
        "TBT": 0,
        "LCP": 835,
        "CLS": 0.001,
        "FCP": 835,
        "SI": 835
      },
      "totalRuns": 3,
      "successfulRuns": 3
    },
    {
      "url": "https://blog.oakenfold.ca/blog/02-01/",
      "calculator": "https://googlechrome.github.io/lighthouse/scorecalc/#FCP=836&SI=836&LCP=836&TBT=0&CLS=0&device=mobile&version=10",
      "passed": true,
      "violationCount": 0,
      "medianLighthouseScore": 100,
      "medianMetrics": {
        "TBT": 0,
        "LCP": 836,
        "CLS": 0,
        "FCP": 836,
        "SI": 836
      },
      "totalRuns": 3,
      "successfulRuns": 3
    }
  ]
}
```
